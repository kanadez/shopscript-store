{$embroidery_cat_name = "Готовые вышивки"}
{$design_cat_name = "Дизайны"}
{$embroideries = []}
{$designs = []}
{$categories = $wa->shop->categories(0, 1, true)}
{if count($categories)}
    {foreach $categories as $cat}
        {if $cat.name == $embroidery_cat_name}
            {foreach $cat.childs as $subcat}
                {$dummy = array_push($embroideries, $subcat)}
            {/foreach}
        {else if $cat.name == $design_cat_name}
            {foreach $cat.childs as $subcat}
                {$dummy = array_push($designs, $subcat)}
            {/foreach}
        {/if}
    {/foreach}
{/if}

{$cell_counter = 0}
{$products_counter = 0}
{function name=showCatalogCell}
    {$design = $designs[$products_counter]}
    {if $cell_counter == 0}
    <div class="big_square fill_lightgray wow fadeIn" data-wow-delay="0.1s" style="background-image: url({$wa->shop->getFirstCategoryProductImage($design)})">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 1}
    <div class="text upper">
        <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
    </div>
    {elseif $cell_counter == 2}
    <div class="text lower">
        <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
    </div>
    {elseif $cell_counter == 3}
    <div class="text lower">
        <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
    </div>
    {elseif $cell_counter == 4}
    <div class="big_square fill_lightgray wow fadeIn" data-wow-delay="0.9s" style="background-image: url({$wa->shop->getFirstCategoryProductImage($design)})">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 5}
    <div class="big_square fill_lightgray wow fadeIn" data-wow-delay="1.1s">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 6}
    <div class="big_square fill_gainsboro wow fadeIn" data-wow-delay="1.3s">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 7}
    <div class="big_square fill_lavender wow fadeIn" data-wow-delay="1.5s">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {/if}

    {$dummy = $products_counter++}        
    {$dummy = $cell_counter++}
{/function}

{function name=showCatalogCellUnderFold}
    {$design = $designs[$products_counter]}
    {if $cell_counter == 0}
    <div class="text upper">
        <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
    </div>
    {elseif $cell_counter == 1}
    <div class="big_square fill_lightgray wow fadeIn" data-wow-delay="0.1s" style="background-image: url({$wa->shop->getFirstCategoryProductImage($design)})">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 2}
    <div class="text lower">
        <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
    </div>
    {elseif $cell_counter == 3}
    <div class="text lower">
        <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
    </div>
    {elseif $cell_counter == 4}
    <div class="big_square fill_lightgray wow fadeIn" data-wow-delay="0.9s" style="background-image: url({$wa->shop->getFirstCategoryProductImage($design)})">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 5}
    <div class="big_square fill_lavender wow fadeIn" data-wow-delay="1.1s">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 6}
    <div class="big_square fill_gainsboro wow fadeIn" data-wow-delay="1.3s">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {elseif $cell_counter == 7}
    <div class="big_square fill_lightgray wow fadeIn" data-wow-delay="1.5s">
        <div class="text">
            <div class="title"><a href="{$design.url}">{$design.name}</a><sup>{$design.count}</sup></div>
            <div class="description">{$design.description}</div>
        </div>
    </div>
    {/if}

    {$dummy = $products_counter++}        
    {$dummy = $cell_counter++}
{/function}

{function name=showTable}
    {$td_counter = 0}
    {foreach $embroideries as $e}
        {if $td_counter == 0}
        <tr>
        {/if}
            <td><b><a href="{$e.url}">~</b> {$e.name}<a></td>
        {if $td_counter == 2}
        </tr>
        {$td_counter = 0}
        {/if}
        {$dummy = $td_counter++}
    {/foreach}
{/function}

{function name=showCatalog}
    {$times_to_show = ceil(count($design_cat_name)/8)}
    {for $i = 0 to $times_to_show}
        {if $i == 0}
            {showCatalogCell}
            <div class="big_square wow fadeIn" data-wow-delay="0.3s">
                <div class="small_square fill_lightsteelblue"></div>
                <div class="small_square fill_lightgray"></div>
                <div class="bar fill_gainsboro">
                    {showCatalogCell}
                </div>
            </div>
            <div class="big_square wow fadeIn" data-wow-delay="0.5s">
                <div class="bar fill_gainsboro">
                    {showCatalogCell}
                </div>
                <div class="bar fill_lightsteelblue">
                    {showCatalogCell}
                </div>
            </div>

            <!--<div class="header_abs wow fadeIn" data-wow-delay="0.1s">
                <header class="header_lk">
                    <div class="top_line">
                        <div class="left firstscreencopy">
                            <div class="sector_menu left">
                                <div class="bng_close"></div>
                                <div class="burger menu-trigger">
                                    <a href="#" class="mob_menu_link"></a>
                                </div>
                            </div>
                            <a href="/" class="asset2"></a>
                            <div class="top_menu" style="display:none">
                                <a href="#" class="active">Каталог</a>  
                                <a href="#">Скидки</a>  
                                <a href="#">Оплата и доставка</a>
                                <a href="#" class="button">Индивидуальный заказ</a>
                            </div>
                        </div>
                        <div class="right firstscreencopy">
                            <div class="profile left">
                                <div class="mini_modal" id="modal_logon">
                                    <a href="/">Выход</a>
                                </div>
                            </div>
                            <div class="cart left top_menu">
                                <a href="/">Корзина (1)</a>
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                </header>
            </div>-->

            <div class="double_square fill_lavender wow fadeIn" data-wow-delay="0.7s">
                <div class="title">Готовые вышивки</div>
                <table id="designs">
                    <tbody>
                        {showTable}
                    </tbody>
                </table>
            </div>

            {showCatalogCell}
            {showCatalogCell}
            {showCatalogCell}
            {showCatalogCell}
            {$cell_counter = 0}
        {else}
            <div class="big_square wow fadeIn" data-wow-delay="0.3s">
                <div class="small_square fill_lavender"></div>
                <div class="small_square fill_lightsteelblue"></div>
                <div class="bar fill_gainsboro">
                    {showCatalogCellUnderFold}
                </div>
            </div>
            {showCatalogCellUnderFold}
            <div class="big_square wow fadeIn" data-wow-delay="0.5s">
                <div class="bar fill_gainsboro">
                    {showCatalogCellUnderFold}
                </div>
                <div class="bar fill_lightsteelblue">
                    {showCatalogCellUnderFold}
                </div>
            </div>
            {showCatalogCellUnderFold}
            <div class="double_square fill_lavender wow fadeIn" data-wow-delay="0.7s">
                
            </div>
            {showCatalogCellUnderFold}
            {showCatalogCellUnderFold}
            {showCatalogCellUnderFold}
            {$cell_counter = 0}
        {/if}
    {/for}
{/function}

<link rel="stylesheet" href="{$wa_theme_url}css/categories.css">

<section class="categories_grid" style="display:none">    
    {showCatalog}
</section>

<script src="{$wa_theme_url}plugins/wow/wow.min.js"></script>
<script src="{$wa_theme_url}js/categories.js"></script>